#!/bin/bash

# Make sure we can run this script from any directory.
bin=`dirname "$0"`/..
bin=`cd "$bin"; pwd`

##
# Script to try and gracefully shut down the journaller. If it is not shut down
# gracefully, the file won't be closed and likely will not be readable.
##
PID_FILE=${1:-journaller.pid}
if [ ! -f $PID_FILE ]; then
  echo "No pid file. Exiting."
  exit
fi
PID=`cat $PID_FILE`

# Check if it's running
VAL=`ps -p ${PID} -o comm=`
if [ -z ${VAL} ]; then
  echo "Journaller is not running"
else
  # kill it "nicely"
  kill -15 $PID
  if [ "$?" = "0" ]; then
    rm $PID_FILE
  fi
fi
